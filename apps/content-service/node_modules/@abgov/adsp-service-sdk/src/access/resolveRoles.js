"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveRoles = void 0;
function resolveRoles(aud, { realm_access, resource_access }) {
    return Object.entries(resource_access || {}).reduce((roles, [client, clientRoles]) => {
        var _a;
        // Include client roles of the current service with unqualified names.
        // These roles are included in both qualified and unqualified forms.
        if (client === aud) {
            roles.push(...((clientRoles === null || clientRoles === void 0 ? void 0 : clientRoles.roles) || []));
        }
        // Include all client roles with qualified names.
        roles.push(...(((_a = clientRoles === null || clientRoles === void 0 ? void 0 : clientRoles.roles) === null || _a === void 0 ? void 0 : _a.map((clientRole) => `${client}:${clientRole}`)) || []));
        return roles;
    }, (realm_access === null || realm_access === void 0 ? void 0 : realm_access.roles) || []);
}
exports.resolveRoles = resolveRoles;
//# sourceMappingURL=resolveRoles.js.map