{"version":3,"file":"set-stages-default-color.mjs","sources":["../../../server/src/migrations/set-stages-default-color.ts"],"sourcesContent":["import { STAGE_DEFAULT_COLOR, STAGE_MODEL_UID } from '../constants/workflows';\n\n/**\n * Set the default color for stages if the color attribute was added\n */\nasync function migrateReviewWorkflowStagesColor({ oldContentTypes, contentTypes }: any) {\n  // Look for CT's color attribute\n  const hadColor = !!oldContentTypes?.[STAGE_MODEL_UID]?.attributes?.color;\n  const hasColor = !!contentTypes?.[STAGE_MODEL_UID]?.attributes?.color;\n\n  // Add the default stage color if color attribute was added\n  if (!hadColor && hasColor) {\n    await strapi.db.query(STAGE_MODEL_UID).updateMany({\n      data: {\n        color: STAGE_DEFAULT_COLOR,\n      },\n    });\n  }\n}\n\nexport default migrateReviewWorkflowStagesColor;\n"],"names":["migrateReviewWorkflowStagesColor","oldContentTypes","contentTypes","hadColor","STAGE_MODEL_UID","attributes","color","hasColor","strapi","db","query","updateMany","data","STAGE_DEFAULT_COLOR"],"mappings":";;AAEA;;AAEC,IACD,eAAeA,gCAAiC,CAAA,EAAEC,eAAe,EAAEC,YAAY,EAAO,EAAA;;AAEpF,IAAA,MAAMC,WAAW,CAAC,CAACF,kBAAkBG,eAAAA,CAAgB,EAAEC,UAAYC,EAAAA,KAAAA;AACnE,IAAA,MAAMC,WAAW,CAAC,CAACL,eAAeE,eAAAA,CAAgB,EAAEC,UAAYC,EAAAA,KAAAA;;IAGhE,IAAI,CAACH,YAAYI,QAAU,EAAA;AACzB,QAAA,MAAMC,OAAOC,EAAE,CAACC,KAAK,CAACN,eAAAA,CAAAA,CAAiBO,UAAU,CAAC;YAChDC,IAAM,EAAA;gBACJN,KAAOO,EAAAA;AACT;AACF,SAAA,CAAA;AACF;AACF;;;;"}