{"version":3,"file":"index.mjs","sources":["../../admin/src/index.ts"],"sourcesContent":["import { SealCheck } from '@strapi/icons';\n\nimport { PLUGIN_ID, FEATURE_ID } from './constants';\nimport { Header } from './routes/content-manager/model/id/components/Header';\nimport { Panel } from './routes/content-manager/model/id/components/Panel';\nimport { addColumnToTableHook } from './utils/cm-hooks';\nimport { prefixPluginTranslations } from './utils/translations';\n\nimport type { StrapiApp, WidgetArgs } from '@strapi/admin/strapi-admin';\nimport type { Plugin } from '@strapi/types';\n\nconst admin: Plugin.Config.AdminInput = {\n  register(app: StrapiApp) {\n    if (window.strapi.features.isEnabled(FEATURE_ID)) {\n      app.registerHook('Admin/CM/pages/ListView/inject-column-in-table', addColumnToTableHook);\n\n      const contentManagerPluginApis = app.getPlugin('content-manager').apis;\n\n      if (\n        'addEditViewSidePanel' in contentManagerPluginApis &&\n        typeof contentManagerPluginApis.addEditViewSidePanel === 'function'\n      ) {\n        contentManagerPluginApis.addEditViewSidePanel([Panel]);\n      }\n\n      app.addSettingsLink('global', {\n        id: PLUGIN_ID,\n        to: `review-workflows`,\n        intlLabel: {\n          id: `${PLUGIN_ID}.plugin.name`,\n          defaultMessage: 'Review Workflows',\n        },\n        licenseOnly: true,\n        permissions: [],\n        async Component() {\n          const { Router } = await import('./router');\n          return { default: Router };\n        },\n      });\n\n      // Always put the assigned to me widget last in the list of widgets\n      app.widgets.register((widgets: WidgetArgs[]) => [\n        ...widgets,\n        {\n          icon: SealCheck,\n          title: {\n            id: `${PLUGIN_ID}.widget.assigned.title`,\n            defaultMessage: 'Assigned to me',\n          },\n          component: async () => {\n            const { AssignedWidget } = await import('./components/Widgets');\n            return AssignedWidget;\n          },\n          pluginId: PLUGIN_ID,\n          id: 'assigned',\n          permissions: [{ action: 'plugin::content-manager.explorer.read' }],\n        },\n      ]);\n    } else if (!window.strapi.features.isEnabled(FEATURE_ID) && window.strapi?.flags?.promoteEE) {\n      app.addSettingsLink('global', {\n        id: PLUGIN_ID,\n        to: `purchase-review-workflows`,\n        intlLabel: {\n          id: `${PLUGIN_ID}.plugin.name`,\n          defaultMessage: 'Review Workflows',\n        },\n        licenseOnly: true,\n        permissions: [],\n        async Component() {\n          const { PurchaseReviewWorkflows } = await import('./routes/purchase-review-workflows');\n          return { default: PurchaseReviewWorkflows };\n        },\n      });\n    }\n  },\n  bootstrap(app: StrapiApp) {\n    if (window.strapi.features.isEnabled(FEATURE_ID)) {\n      app.getPlugin('content-manager').injectComponent('preview', 'actions', {\n        name: 'review-workflows-assignee',\n        Component: Header,\n      });\n    }\n  },\n  async registerTrads({ locales }: { locales: string[] }) {\n    const importedTrads = await Promise.all(\n      locales.map((locale) => {\n        return import(`./translations/${locale}.json`)\n          .then(({ default: data }) => {\n            return {\n              data: prefixPluginTranslations(data, PLUGIN_ID),\n              locale,\n            };\n          })\n          .catch(() => {\n            return {\n              data: {},\n              locale,\n            };\n          });\n      })\n    );\n\n    return Promise.resolve(importedTrads);\n  },\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default admin;\n"],"names":["admin","register","app","window","strapi","features","isEnabled","FEATURE_ID","registerHook","addColumnToTableHook","contentManagerPluginApis","getPlugin","apis","addEditViewSidePanel","Panel","addSettingsLink","id","PLUGIN_ID","to","intlLabel","defaultMessage","licenseOnly","permissions","Component","Router","default","widgets","icon","SealCheck","title","component","AssignedWidget","pluginId","action","flags","promoteEE","PurchaseReviewWorkflows","bootstrap","injectComponent","name","Header","registerTrads","locales","importedTrads","Promise","all","map","locale","then","data","prefixPluginTranslations","catch","resolve"],"mappings":"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"}