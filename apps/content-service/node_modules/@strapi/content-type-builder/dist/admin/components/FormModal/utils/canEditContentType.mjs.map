{"version":3,"file":"canEditContentType.mjs","sources":["../../../../../admin/src/components/FormModal/utils/canEditContentType.ts"],"sourcesContent":["import { getRelationType } from '../../../utils/getRelationType';\n\nimport type { AnyAttribute, ContentType } from '../../../types';\nimport type { Internal, Struct } from '@strapi/types';\n\nexport type EditableContentTypeSchema = {\n  kind: Struct.ContentTypeKind;\n  name: string;\n  attributes: AnyAttribute[];\n};\n\nexport type EditableContentTypeData = {\n  contentType: {\n    uid: Internal.UID.ContentType;\n    schema: EditableContentTypeSchema;\n  };\n};\n\ntype ModifiedData = {\n  kind?: Struct.ContentTypeKind;\n};\n\nexport const canEditContentType = (type: ContentType, modifiedData: ModifiedData) => {\n  const kind = type.kind;\n\n  // if kind isn't modified or content type is a single type, there is no need to check attributes.\n  if (kind === 'singleType' || kind === modifiedData.kind) {\n    return true;\n  }\n\n  const contentTypeAttributes: AnyAttribute[] = type?.attributes ?? [];\n\n  const relationAttributes = contentTypeAttributes.filter((attribute) => {\n    if (attribute.type !== 'relation') {\n      return false;\n    }\n\n    const { relation, targetAttribute } = attribute;\n    const relationType = getRelationType(relation, targetAttribute);\n\n    return !['oneWay', 'manyWay'].includes(relationType || '');\n  });\n\n  return relationAttributes.length === 0;\n};\n"],"names":["canEditContentType","type","modifiedData","kind","contentTypeAttributes","attributes","relationAttributes","filter","attribute","relation","targetAttribute","relationType","getRelationType","includes","length"],"mappings":";;AAsBO,MAAMA,kBAAqB,GAAA,CAACC,IAAmBC,EAAAA,YAAAA,GAAAA;IACpD,MAAMC,IAAAA,GAAOF,KAAKE,IAAI;;AAGtB,IAAA,IAAIA,IAAS,KAAA,YAAA,IAAgBA,IAASD,KAAAA,YAAAA,CAAaC,IAAI,EAAE;QACvD,OAAO,IAAA;AACT;IAEA,MAAMC,qBAAAA,GAAwCH,IAAMI,EAAAA,UAAAA,IAAc,EAAE;AAEpE,IAAA,MAAMC,kBAAqBF,GAAAA,qBAAAA,CAAsBG,MAAM,CAAC,CAACC,SAAAA,GAAAA;QACvD,IAAIA,SAAAA,CAAUP,IAAI,KAAK,UAAY,EAAA;YACjC,OAAO,KAAA;AACT;AAEA,QAAA,MAAM,EAAEQ,QAAQ,EAAEC,eAAe,EAAE,GAAGF,SAAAA;QACtC,MAAMG,YAAAA,GAAeC,gBAAgBH,QAAUC,EAAAA,eAAAA,CAAAA;AAE/C,QAAA,OAAO,CAAC;AAAC,YAAA,QAAA;AAAU,YAAA;SAAU,CAACG,QAAQ,CAACF,YAAgB,IAAA,EAAA,CAAA;AACzD,KAAA,CAAA;IAEA,OAAOL,kBAAAA,CAAmBQ,MAAM,KAAK,CAAA;AACvC;;;;"}