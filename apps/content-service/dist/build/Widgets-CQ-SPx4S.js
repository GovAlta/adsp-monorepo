import{cu as I,e as j,T as m,a as p,j as e,f,af as N,b as S,$ as F,cv as A,cw as B,cx as P,cy as x,aM as y,a5 as W,a6 as z,cz as O,a9 as U,h as q,r as G,cA as H}from"./strapi-CZE0NOhr.js";import{W as u}from"./WidgetHelpers-CQjeCQVt.js";const K=I.enhanceEndpoints({addTagTypes:["RecentDocumentList"]}).injectEndpoints({overrideExisting:!0,endpoints:n=>({getRecentDocuments:n.query({query:s=>`/content-manager/homepage/recent-documents?action=${s.action}`,transformResponse:s=>s.data,providesTags:(s,i,{action:o})=>[{type:"RecentDocumentList",id:o}]})})}),{useGetRecentDocumentsQuery:$}=K,v=j(m)`
  display: block;
  max-width: 14.4rem;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,D=({documents:n,type:s})=>{const{formatMessage:i}=p(),{trackUsage:o}=S(),l=F(),c=a=>{const d=a.kind==="singleType",b=d?"single-types":"collection-types",t=a.locale?`?plugins[i18n][locale]=${a.locale}`:"";return`/content-manager/${b}/${a.contentTypeUid}${d?"":"/"+a.documentId}${t}`},h=a=>()=>{o("willEditEntryFromHome",{entryType:s});const d=c(a);l(d)};return e.jsx(A,{colCount:5,rowCount:n?.length??0,children:e.jsx(B,{children:n?.map(a=>e.jsxs(P,{onClick:h(a),cursor:"pointer",children:[e.jsx(x,{children:e.jsx(v,{title:a.title,variant:"omega",textColor:"neutral800",children:a.title})}),e.jsx(x,{children:e.jsx(v,{variant:"omega",textColor:"neutral600",children:a.kind==="singleType"?i({id:"content-manager.widget.last-edited.single-type",defaultMessage:"Single-Type"}):i({id:a.contentTypeDisplayName,defaultMessage:a.contentTypeDisplayName})})}),e.jsx(x,{children:e.jsx(y,{display:"inline-block",children:a.status?e.jsx(W,{status:a.status}):e.jsx(m,{textColor:"neutral600","aria-hidden":!0,children:"-"})})}),e.jsx(x,{children:e.jsx(m,{textColor:"neutral600",children:e.jsx(z,{timestamp:new Date(a.updatedAt)})})}),e.jsx(x,{onClick:d=>d.stopPropagation(),children:e.jsx(y,{display:"inline-block",children:e.jsx(O,{tag:U,to:c(a),onClick:()=>o("willEditEntryFromHome",{type:s}),label:i({id:"content-manager.actions.edit.label",defaultMessage:"Edit"}),variant:"ghost",children:e.jsx(q,{})})})})]},a.documentId))})})},J=()=>{const{formatMessage:n}=p(),{data:s,isLoading:i,error:o}=$({action:"update"});return i?e.jsx(u.Loading,{}):o||!s?e.jsx(u.Error,{}):s.length===0?e.jsx(u.NoData,{children:n({id:"content-manager.widget.last-edited.no-data",defaultMessage:"No edited entries"})}):e.jsx(D,{documents:s,type:"edited"})},Z=()=>{const{formatMessage:n}=p(),{data:s,isLoading:i,error:o}=$({action:"publish"});return i?e.jsx(u.Loading,{}):o||!s?e.jsx(u.Error,{}):s.length===0?e.jsx(u.NoData,{children:n({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})}):e.jsx(D,{documents:s,type:"published"})},r=80,T=10,C=2*Math.PI*(r-T/2),Q=j.circle`
  stroke: ${({theme:n,$arcColor:s})=>n.colors[s]};
`,k=j.tspan`
  text-transform: lowercase;
  fill: ${({theme:n,$textColor:s})=>n.colors[s]};
`,V=j(f)`
  width: 100%;

  ${({theme:n})=>n.breakpoints.small} {
    width: auto;
  }
`,X=({data:n})=>{const{locale:s}=p(),{formatMessage:i}=p(),o=n.reduce((t,g)=>t+g.count,0),[l,c]=G.useState({visible:!1,x:0,y:0,value:null});let h=0;const a=(t,g)=>{c({visible:!0,x:t.clientX,y:t.clientY,value:g})},d=()=>{c(t=>({...t,visible:!1}))},b=(t,g)=>{c({visible:!0,x:t.currentTarget.getBoundingClientRect().width/2+t.currentTarget.getBoundingClientRect().left,y:t.currentTarget.getBoundingClientRect().height+t.currentTarget.getBoundingClientRect().top,value:g})};return e.jsxs(f,{direction:"column",gap:6,margin:"auto",children:[e.jsxs("svg",{width:r*2,height:r*2,viewBox:`0 0 ${r*2} ${r*2}`,style:{position:"relative",zIndex:1},children:[e.jsx("g",{transform:`rotate(-90 ${r} ${r})`,children:n.map(t=>{const g=t.count/o*100,M=g/100*C,E=`${M} ${C-M}`,R=C*(1-h/100),L=e.jsx(Q,{cx:r,cy:r,r:r-T/2,fill:"none",strokeWidth:T,strokeDasharray:E,strokeDashoffset:R,style:{transition:"stroke-dashoffset 0.3s",cursor:"pointer"},tabIndex:0,"aria-describedby":l.visible?"chart-tooltip":void 0,onFocus:w=>b(w,t),onBlur:d,onMouseMove:w=>a(w,t),onMouseLeave:d,$arcColor:t.color},t.label);return h+=g,L})}),e.jsxs("text",{x:r,y:r,textAnchor:"middle",fontSize:"2.4rem",fontWeight:"bold",children:[e.jsx(k,{x:r,dy:"0",$textColor:"neutral800",children:new Intl.NumberFormat(s,{notation:"compact",maximumFractionDigits:1}).format(o)}),e.jsx(k,{x:r,dy:"1.4em",fontSize:"1.4rem",fontWeight:"normal",$textColor:"neutral600",children:i({id:"content-manager.widget.chart-entries.count.label",defaultMessage:"{count, plural, =0 {entries} one {entry} other {entries}}"},{count:o})})]})]}),l.visible&&l.value&&e.jsx(H,{style:{position:"fixed",left:16,top:16,zIndex:2,transform:`translate(${l.x}px, ${l.y}px)`},"data-testid":"entries-chart-tooltip",children:e.jsx(y,{background:"neutral900",padding:2,borderRadius:1,textAlign:"center",role:"tooltip","aria-live":"polite",children:e.jsx(m,{textColor:"neutral0",children:i({id:"content-manager.widget.chart-entries.tooltip",defaultMessage:"{count} items"},{count:l.value.count,label:l.value.label})})})}),e.jsx(f,{gap:4,wrap:"wrap",children:n.map(t=>t.count>0&&e.jsxs(V,{gap:1,children:[e.jsx(y,{background:t.color,padding:2,borderRadius:1}),e.jsx(m,{variant:"pi",children:t.label})]},t.label))})]})},ee=()=>{const{formatMessage:n}=p(),{data:s,isLoading:i,error:o}=N();if(i)return e.jsx(u.Loading,{});if(o)return e.jsx(u.Error,{});const{draft:l,published:c,modified:h}=s??{draft:0,published:0,modified:0};return l+c+h?e.jsx(f,{minHeight:"100%",children:e.jsx(X,{data:[{label:n({id:"content-manager.containers.List.draft",defaultMessage:"Draft"}),count:l,color:"secondary500"},{label:n({id:"content-manager.containers.List.modified",defaultMessage:"Modified"}),count:h,color:"alternative500"},{label:n({id:"content-manager.containers.List.published",defaultMessage:"Published"}),count:c,color:"success500"}]})}):e.jsx(u.NoData,{children:n({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})})};export{ee as ChartEntriesWidget,J as LastEditedWidget,Z as LastPublishedWidget};
