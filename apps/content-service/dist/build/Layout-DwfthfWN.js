const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["strapi-CZE0NOhr.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{r as h,ab as v,fl as _,ax as I,o as T,fm as D,bP as A,_ as C,e as B,ad as O,a as N,b as U,b0 as F,c9 as R,j as t,fn as c,bC as G,fo as H,aY as K,P as M,b1 as V,D as $,fp as W}from"./strapi-CZE0NOhr.js";import{s as Y}from"./sortBy-B4qcwP3a.js";import{s as q}from"./selectors-BizX_yWc.js";import"./_baseMap-DwW8IPUQ.js";import"./_baseEach-BupwFL9F.js";const z=i=>i.map(a=>{const o=a.links.map(n=>({...n,isDisplayed:!1}));return{...a,links:o}}),J=()=>{const[{isLoading:i,menu:a},o]=h.useState({isLoading:!0,menu:[]}),n=v("useSettingsMenu",s=>s.checkUserHasPermissions),u=_("useSettingsMenu",s=>s.shouldUpdateStrapi),m=I("useSettingsMenu",s=>s.settings),g=T(q),P=h.useMemo(()=>D(),[]),{admin:p,global:r}=A(P,async()=>(await C(async()=>{const{SETTINGS_LINKS_EE:s}=await import("./strapi-CZE0NOhr.js").then(e=>e.oi);return{SETTINGS_LINKS_EE:s}},__vite__mapDeps([0,1]))).SETTINGS_LINKS_EE(),{combine(s,e){return{admin:[...e.admin,...s.admin],global:[...s.global,...e.global]}},defaultValue:{admin:[],global:[]}}),l=h.useCallback(s=>{if(!s.id)throw new Error("The settings menu item must have an id attribute.");return{...s,permissions:g.settings?.[s.id]?.main??[]}},[g.settings]);return h.useEffect(()=>{const s=async()=>{const E=await(L=>Promise.all(L.reduce((f,S,x)=>{const k=S.links.map(async(j,b)=>({hasPermission:(await n(j.permissions)).length>0,sectionIndex:x,linkIndex:b}));return[...f,...k]},[])))(y);o(L=>({...L,isLoading:!1,menu:y.map((f,S)=>({...f,links:f.links.map((x,k)=>{const j=E.find(b=>b.sectionIndex===S&&b.linkIndex===k);return{...x,isDisplayed:!!j?.hasPermission}})}))}))},{global:e,...w}=m,y=z([{...e,links:Y([...e.links,...r.map(l)],d=>d.id).map(d=>({...d,hasNotification:d.id==="000-application-infos"&&u}))},{id:"permissions",intlLabel:{id:"Settings.permissions",defaultMessage:"Administration Panel"},links:p.map(l)},...Object.values(w)]);s()},[p,r,m,u,l,n]),{isLoading:i,menu:a.map(s=>({...s,links:s.links.filter(e=>e.isDisplayed)}))}},Q=B(O)`
  border-radius: 50%;
  padding: ${({theme:i})=>i.spaces[2]};
  height: 2rem;
`,X=({menu:i})=>{const{formatMessage:a}=N(),{trackUsage:o}=U(),{pathname:n}=F(),{license:u}=R(),m=u?.features.map(s=>s.name),g={"content-releases":"cms-content-releases","review-workflows":"review-workflows",sso:"sso",auditLogs:"audit-logs","auditLogs-purchase-page":"audit-logs"},p=i.filter(s=>!s.links.every(e=>e.isDisplayed===!1)).map(s=>({...s,title:s.intlLabel,links:s.links.map(e=>({...e,id:e.id,title:e.intlLabel,name:e.id}))})),r=a({id:"global.settings",defaultMessage:"Settings"}),l=s=>()=>{o("willNavigate",{from:n,to:s})};return t.jsxs(c.Main,{"aria-label":r,children:[t.jsx(c.Header,{label:r}),t.jsx(G,{background:"neutral150",marginBottom:5}),t.jsx(c.Sections,{children:p.map(s=>t.jsx(c.Section,{label:a(s.intlLabel),children:s.links.map(e=>t.jsx(c.Link,{to:e.to,onClick:l(e.to),label:a(e.intlLabel),endAction:t.jsxs(t.Fragment,{children:[e?.licenseOnly&&t.jsx(H,{fill:(m||[]).includes(g[e.id])?"primary600":"neutral300",width:"1.5rem",height:"1.5rem"}),e?.hasNotification&&t.jsx(Q,{"aria-label":"Notification",backgroundColor:"primary600",textColor:"neutral0",children:"1"})]})},e.id))},s.id))})]})},is=()=>{const i=K("/settings/:settingId/*"),{formatMessage:a}=N(),{isLoading:o,menu:n}=J();return o?t.jsx(M.Loading,{}):i?.params.settingId?t.jsxs($.Root,{sideNav:t.jsx(X,{menu:n}),children:[t.jsx(M.Title,{children:a({id:"global.settings",defaultMessage:"Settings"})}),t.jsx(W,{})]}):t.jsx(V,{to:"application-infos"})};export{is as Layout};
